# yaml-language-server: $schema=https://carapace.sh/schemas/command.json
# This is basically a port of the fig spec inshellisense uses
name: idea
description: IntelliJ IDEA CLI
flags:
  --wait: Wait for the files to be closed before returning to the command prompt
completion:
  positionalany:
    # These are closer to flags but idk how to include them without a full spec
    - "nosplash\tDo not show the splash screen when loading"
    - "dontReopenProjects\tDo not reopen projects and show the welcome screen"
    - "disableNonBundledPlugins\tDo not load manually installed plugins"
    - $files

commands:
  - name: diff
    description: Open the diff viewer to see the differences between two specified files
    completion:
      positional:
        - [$files]
        - [$files]
        - [$files]

  - name: merge
    description: Open the Merge dialog to merge the specified files
    completion:
      positional:
        - [$files]
        - [$files]
        - [$files]

  - name: format
    description: Apply code style formatting to the specified files
    flags:
      -h: Show help for format command
      -m, -mask=: Specify a comma-separated list of file masks that define the files to be processed
      -r, -R: Process specified directories recursively
      -s, -settings=: Specify the code style settings file to use for formatting
      -allowDefaults: Use the default code style settings when the code style is not defined for a file
      -charset=: Preserve encoding and enforce the charset for reading and writing source files
      -d, -dry: Run the formatter in the validation mode
    completion:
      positionalany:
        - $files

  - name: inspect
    description: Perform code inspection on the specified project
    flags:
      -changes: Run inspections only on local uncommitted changes
      -d: Specify the full path to the subdirectory if you don't want to inspect the whole project
      -format=: Specify the format of the output file with inspection results
      -v: Set the verbosity level of the output
    completion:
      flag:
        format: ["xml\tdefault", json, plain]
      positional:
        - [$directories]
        - [$files]
        - [$files]

  - name: installPlugins
    description: Install plugins by plugin ID from JetBrains Marketplace or a custom plugin repository
