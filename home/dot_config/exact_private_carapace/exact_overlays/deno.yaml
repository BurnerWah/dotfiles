name: deno
commands:
  - name: serve
    description: Run a server

  - name: add
    description: Add dependencies
    flags:
      <<:
        - --allow-scripts=: Allow running npm lifecycle scripts for the given packages
          -D, --dev: Add the package as a dev dependency
          --jsr: assume unprefixed package names are jsr packages
          --lockfile-only: Install only updating the lockfile
          --npm: assume unprefixed package names are npm packages
        - &dependency_management_options_flags
          --frozen=: Error out if lockfile is out of date
          --lock=?: Check the specified lock file
          --no-lock: Disable auto discovery of the lock file
    exclusiveflags:
      - [jsr, npm]
    completion:
      flag:
        <<:
          - &dependency_management_options_completion
            frozen: ['true', 'false']
            lock: [$files]
      positionalany:
        # TODO add JSR search
        - '$carapace.tools.npm.PackageNames ||| $prefix(npm:)'

  - name: outdated
    description: Find and update outdated dependencies

  - name: approve-scripts
    description: Approve npm lifecycle scripts

  - name: remove
    description: Remove dependencies from the configuration file
    flags:
      <<:
        - --lockfile-only: Install only updating the lockfile
        - *dependency_management_options_flags
    completion:
      flag: *dependency_management_options_completion
      # TODO complete packages

  - name: clean
    description: Remove the cache directory

  - name: deploy
    description: Manage and publish applications with Deno Deploy

  - name: jupyter
    description: Deno kernel for Jupyter notebooks

  - name: init
    description: Initialize a new project

  - name: publish
    description: Publish the current working directory's package or workspace
